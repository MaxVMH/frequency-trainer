<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="description" content="Frequency Trainer is a free online (audio) frequency trainer."/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Frequency Trainer</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:900" />
    <link rel="stylesheet" type="text/css" href="css/default.css" />
    <script src="frequencyTrainer.js"></script>
</head>
<body>
    <div class="body">
        <div class="title">
            <h1>Frequency Trainer</h1>
        </div>
        <div class="controls">
            <br />
            <button type="button" id="start-button" class="control-button">Start</button>
            <button type="button" id="stop-button" class="control-button">Stop</button>
            <button type="button" id="next-button" class="control-button">Next</button><br />
            <br />
            Volume:<br />
            <input id="volume-control" type="range" min="0" max="20" value="2" step="0.1" class="volume-control" /><br />
            <br />
            <a href="?mode=easy"><button type="button" id="difficulty-easy" class="control-button">Easy</button></a>
            <a href="?mode=normal"><button type="button" id="difficulty-normal" class="control-button">Normal</button></a>
            <a href="?mode=hard"><button type="button" id="difficulty-hard" class="control-button">Hard</button></a>
            <a href="?mode=pro"><button type="button" id="difficulty-pro" class="control-button">Pro</button></a><br />
            <br />
        </div>
        <div class="grid">
        </div>
        <div class="footer">
            v.0.0.3<br />
            <a href="info.html">info</a> - <a href="http://beta.frequencytrainer.com">beta</a> - <a href="https://github.com/MaxVMH/frequency-trainer">code</a>
        </div>
    </div>

    <script>
    // Initiate frequencyTrainer
    let difficultyMode = getDifficultyMode();
    let frequencyTrainer = createFrequencyTrainer(difficultyMode);
    let frequency = frequencyTrainer.frequency;

    // Control buttons
    let startButton = document.getElementById("start-button");
    startButton.onclick = function () {
        stopToneGenerator();
        startToneGenerator(frequency, volumeControl, 0, 3);
    };
    let stopButton = document.getElementById("stop-button");
    stopButton.onclick = function () {
        stopToneGenerator();
    };
    let nextButton = document.getElementById("next-button");
    nextButton.onclick = function () {
        frequency = changeFrequency(difficultyMode, frequency).frequency;
        stopToneGenerator();
        startToneGenerator(frequency, volumeControl, 0.1, 3);
    };
    let volumeControl = document.getElementById("volume-control");
    volumeControl.oninput = function () {
        changeVolume(volumeControl);
    };

    // Create grid with frequencies
    let selectedFrequencyFormatted = null;
    let frequencyGrid = document.getElementsByClassName('grid')[0];
    for (selectedFrequency of frequencyTrainer.frequencies)
    {
        selectedFrequencyFormatted = frequencyFormatter(selectedFrequency);
        frequencyGrid.insertAdjacentHTML('beforeend', '<div class="frequency-container" data-frequency="' + selectedFrequency + '">' + selectedFrequencyFormatted + 'Hz</div>');
    };

    // Show the result when user clicks on a frequency
    let frequencyContainers = document.getElementsByClassName('frequency-container');
    for (let frequencyContainer of frequencyContainers) {
        frequencyContainer.addEventListener('click', function(e) {
            stopToneGenerator();
            let frequencyChosen = e.target.getAttribute('data-frequency');
            let frequencyChosenFormatted = frequencyFormatter(frequencyChosen);

            if(getResult(frequencyChosen, frequency) === true) {
                if (window.confirm(frequencyChosenFormatted + 'Hz is correct!\nLet\'s try another one!')) {
                    frequency = changeFrequency(difficultyMode, frequencyChosen).frequency;
                    startToneGenerator(frequency, volumeControl, 0.1, 3);
                }
            }
            else {
                window.alert(frequencyChosenFormatted + 'Hz is not correct.\nPlease try again.');
                startToneGenerator(frequency, volumeControl, 0.1, 3);
            }
        });
    }
    </script>
</body>
</html>
